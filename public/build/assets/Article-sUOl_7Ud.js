import{q as p,u as h,g as f,s as l,v as c}from"./app-Dyzhh59B.js";var r=[];for(var u=0;u<256;++u)r.push((u+256).toString(16).slice(1));function g(i,t=0){return(r[i[t+0]]+r[i[t+1]]+r[i[t+2]]+r[i[t+3]]+"-"+r[i[t+4]]+r[i[t+5]]+"-"+r[i[t+6]]+r[i[t+7]]+"-"+r[i[t+8]]+r[i[t+9]]+"-"+r[i[t+10]]+r[i[t+11]]+r[i[t+12]]+r[i[t+13]]+r[i[t+14]]+r[i[t+15]]).toLowerCase()}var n,b=new Uint8Array(16);function m(){if(!n&&(n=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(b)}var y=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const o={randomUUID:y};function s(i,t,e){if(o.randomUUID&&!t&&!i)return o.randomUUID();i=i||{};var a=i.random||(i.rng||m)();if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,t){e=e||0;for(var d=0;d<16;++d)t[e+d]=a[d];return t}return g(a)}const w=p("Article",{state:()=>({users_id:[],model:{id:s,date:new Date().toISOString().substr(0,10),description:"",price:null,is_private:!1,star:!1,product_id:null},models:[{id:s(),date:new Date().toISOString().substr(0,10),description:"",price:null,is_private:!1,star:!1,product_id:null}],article_filter:["0","3"],dashboard:h(),auth:f()}),actions:{deleteModel:function(i){this.models=this.models.filter(t=>t.id!=i)},deleteArticle:async function(i){await l.delete(`/api/articles/${i}`).then(t=>(this.dashboard.articles=this.dashboard.articles.filter(e=>e.id!=i),t))},postArticles:async function(){return this.models.forEach(i=>i.date=c(i.date).format("YYYY-MM-DD")),await l.post("/api/articles",{articles:this.models}).then(i=>(this.models=[{id:s(),date:new Date().toISOString().substr(0,10),description:"",price:null,is_private:!1,star:!1,product_id:null}],i)).catch(i=>{console.log("error",i)})},getArticle:async function(i){return await l.get(`/api/articles/${i}`).then(t=>t.data.article)},updateArticle:async function(i){i.date=c(i.date).format("YYYY-MM-DD"),await l.patch(`/api/articles/${i.id}`,{article:i}).then(t=>{let e=this.dashboard.articles.find(a=>a.id==i.id);e&&(e.date=t.data.article.date,e.name=t.data.article.name,e.description=t.data.article.description,e.price=t.data.article.price,e.is_private=t.data.article.is_private,e.star=t.data.article.star,e.product_id=t.data.article.product_id)})},cancelBill:async function(i){await l.patch(`/api/articles/${i.id}`,{article:{bill_id:null},update_bill:!0}).then(t=>{let e=this.dashboard.articles.find(a=>a.id==i.id);e&&(e.bill_id=t.data.article.bill_id)})},makeBill:async function(){return await l.post("/api/bills",{articles:this.getBillQueue.map(i=>i.id),users_id:this.users_id}).then(i=>(this.getBillQueue.forEach(t=>{let e=this.dashboard.articles.find(a=>a.id==t.id);e.bill_id=i.data.bill.id}),i.data.bill)).catch(i=>!0)},toggleBill:function(i){let t=this.dashboard.articles.find(e=>e.id==i);t&&(t.bill_id=!t.bill_id)},toggleBills:function(i){this.articles.filter(t=>typeof t.bill_id=="object"||typeof t.bill_id=="boolean").forEach(t=>t.bill_id=!i)},resetBillPlanning:function(){this.getBillQueue.map(i=>i.bill_id=!1)},addArticle:function(){this.models.push({id:s(),date:new Date().toISOString().substr(0,10),description:"",price:null,is_private:!1,star:!1,product_id:null})}},getters:{articles:i=>{let t=[];return i.article_filter.find(e=>e=="0")&&t.push(...i.regular_articles.filter(e=>i.auth.getAuth.id==e.user_id)),i.article_filter.find(e=>e=="1")&&t.push(...i.regular_articles.filter(e=>!e.is_private&&e.user_id!=i.auth.getAuth.id)),i.article_filter.find(e=>e=="2")&&(t=t.filter(e=>e.bill_id)),i.article_filter.find(e=>e=="3")?t=t.filter(e=>!e.is_private):t=t.filter(e=>e.is_private),t=t.filter(e=>i.users_id.includes(e.user_id)),_.orderBy(t,["star","date"],["desc","desc"])},total_articles:i=>_.sumBy(i.articles,"price"),total_articles_selected:i=>_.sumBy(i.getBillQueue,"price"),getBillQueue:i=>i.regular_articles.filter(t=>t.bill_id===!0),regular_articles:i=>i.dashboard.articles.filter(t=>t.user_id==i.auth.getAuth.id||t.user_id!=i.auth.getAuth.id&&!t.is_private)}});export{w as u};
