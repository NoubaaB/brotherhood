import{_ as E,q as L,g as O,r as a,o as i,e as h,h as s,a as n,w as t,b as u,t as c,c as _,j as m,F as A,f as T,n as R,k as G}from"./app-DPBEIOZQ.js";const b={props:{bill:Object},data:function(){return{expand_articles:!1,expand_invoices:!1,loading:!1,loading_bill:!1,on_delete:!1,pause:!1,setTimeout:null,setInterval:null,counter:1,color:"white"}},mounted:function(){this.bill.user_id==this.auth.getAuth.id&&this.$nextTick(()=>{const e="#"+this.bill.id,r=new Swiper(e,{resistanceRatio:.85,initialSlide:0,resistance:!0,allowSlideNext:!1,momentumBounce:!0,speed:150});r.on("transitionStart",()=>{this.on_delete=!0,this.loading=!0,this.setTimeout=setTimeout(()=>{this.deleteBill().then(o=>{r.destroy()})},3e3),this.setInterval=setInterval(()=>{++this.counter},1e3)})})},computed:{_bill:function(){return L()},dashboard:function(){return useDashboard()},auth:function(){return O()}},methods:{deleteBill:async function(){return await this._bill.deleteBill(this.bill.id).then(e=>{this.$route.params.id&&this.$router.push({name:"bills.list"})})},aditBill:function(){this.$router.push({name:"bills.update",params:{id:this.bill.id}})},viewBill:function(){this.$router.push({name:"bills.view",params:{id:this.bill.id}})},cancelBill:async function(){return this.loading_bill=!0,await this._bill.cancelBill(this.bill).then(e=>(this.loading_bill=!1,e))},toggleBill:function(){this._bill.toggleBill(this.bill.id)},unBillArticle:async function(e,r){await this._bill.unBillArticle(e,r).then(o=>{o&&(this.bill.articles=this.bill.articles.filter(f=>f.id!=e))})},rollback:function(){this.pause=!0,clearTimeout(this.setTimeout),clearInterval(this.setInterval),this.on_delete=!1,this.counter=1,setTimeout(()=>{this.loading=!1,this.pause=!1},1e3)},toggleInvoice:function(e){this._bill.toggleInvoice(e.id,!e.checked),e.checked=!e.checked},goTo:function(e){this.$router.push(`/articles/view/${e}`)}}},z=()=>{G(e=>({dc31bdfe:e.color}))},D=b.setup;b.setup=D?(e,r)=>(z(),D(e,r)):z;const H=["id"],J={class:"swiper-wrapper"},K={class:"swiper-slide"},P={key:1},Q=s("thead",null,[s("tr",null,[s("th",{class:"text-left pr-0"}," Name "),s("th",{class:"text-left px-0"}," Spent "),s("th",{class:"text-left px-0"}," Amount "),s("th",{class:"text-left"})])],-1),U={class:"text-left pr-0"},W={class:"text-left px-0 text-red"},X={class:"text-left px-0"},Y={class:"text-left px-0"},Z={key:0,class:"bg-blue-lighten-5"},$={class:"d-inline"},ee={class:"d-inline text-green"};function te(e,r,o,f,le,d){const I=a("v-progress-linear"),p=a("v-chip"),g=a("v-icon"),N=a("v-card-text"),S=a("v-progress-circular"),k=a("v-checkbox"),x=a("v-img"),y=a("v-avatar"),B=a("v-spacer"),v=a("v-btn"),M=a("v-card-actions"),V=a("v-table"),w=a("v-expand-transition"),j=a("v-list-item"),F=a("v-list"),q=a("v-card");return i(),h("div",{id:o.bill.id,class:"swiper-container"},[s("div",J,[s("div",K,[n(q,{hover:"",class:R(["mx-auto",{on_delete:e.on_delete}])},{loader:t(()=>[n(I,{active:e.loading_bill,indeterminate:"",height:"3",color:"blue"},null,8,["active"])]),subtitle:t(()=>[u(c(o.bill.date)+" | Created : ",1),d.auth.getAuth.id==o.bill.user_id?(i(),_(p,{key:0,size:"x-small",color:"green"},{default:t(()=>[u("Me")]),_:1})):(i(),_(p,{key:1,size:"x-small",color:"blue"},{default:t(()=>[u(c(o.bill.user.name),1)]),_:1}))]),title:t(()=>[u(" Bill NÂ° : "+c(o.bill.id),1)]),append:t(()=>[e.loading?(i(),h("div",{key:0,class:"cursor-pointer",onClick:r[0]||(r[0]=(...l)=>d.rollback&&d.rollback(...l))},[n(S,{size:30,width:1,color:"primary",indeterminate:""},{default:t(()=>[e.pause?(i(),_(g,{key:0},{default:t(()=>[u(" mdi-pause ")]),_:1})):(i(),h("span",P,c(e.counter),1))]),_:1})])):m("",!0),s("div",null,[!e.$route.params.id&&d.auth.getAuth.id==o.bill.user_id?(i(),_(k,{key:0,"model-value":!!o.bill.selected,"hide-details":"",onClick:d.toggleBill,color:"primary"},null,8,["model-value","onClick"])):m("",!0)])]),prepend:t(()=>[n(y,{rounded:"0"},{default:t(()=>[n(x,{alt:"receipt",class:"img_border_radius",src:"/storage/receipt.gif"})]),_:1})]),default:t(()=>[n(N,null,{default:t(()=>[n(g,{color:"green",class:"mx-3 pb-2"},{default:t(()=>[u("mdi-cash-multiple")]),_:1}),s("strong",null,c(o.bill.amount),1),u(" MAD ")]),_:1}),n(B),n(M,{class:"bg-blue-lighten-5"},{default:t(()=>[n(B),n(v,{class:"mr-2",color:"deep-purple-darken-1",size:"x-small",variant:"tonal",icon:e.expand_invoices?"mdi-chevron-up":"mdi-chevron-down",onClick:r[1]||(r[1]=l=>e.expand_invoices=!e.expand_invoices)},null,8,["icon"]),n(v,{class:"mr-2",color:"blue-darken-1",size:"x-small",variant:"tonal",icon:e.expand_articles?"mdi-chevron-up":"mdi-chevron-down",onClick:r[2]||(r[2]=l=>e.expand_articles=!e.expand_articles)},null,8,["icon"]),e.$route.params.id?m("",!0):(i(),_(v,{key:0,class:"mr-2",color:"green-darken-1",size:"x-small",variant:"tonal",icon:"mdi-text-box",onClick:d.viewBill},null,8,["onClick"]))]),_:1}),n(w,null,{default:t(()=>[e.expand_invoices?(i(),_(V,{key:0},{default:t(()=>[Q,s("tbody",null,[(i(!0),h(A,null,T(o.bill.invoices,l=>(i(),h("tr",{key:l.id},[s("td",U,c(l.user.name),1),s("td",W," -"+c(l.spent)+" MAD ",1),s("td",X,[l.price>0?(i(),_(p,{key:0,variant:"tonal",color:"green"},{default:t(()=>[u(c(l.price)+" MAD",1)]),_:2},1024)):l.price==0?(i(),_(p,{key:1,variant:"tonal",color:"gray"},{default:t(()=>[u(c(l.price)+" MAD",1)]),_:2},1024)):(i(),_(p,{key:2,variant:"tonal",color:"red"},{default:t(()=>[u(c(l.price)+" MAD",1)]),_:2},1024))]),s("td",Y,[n(k,{"model-value":!!l.checked,"hide-details":"",onClick:C=>d.toggleInvoice(l),color:"primary",disabled:d.auth.getAuth.id!=l.user_id},null,8,["model-value","onClick","disabled"])])]))),128))])]),_:1})):m("",!0)]),_:1}),n(w,null,{default:t(()=>[e.expand_articles?(i(),h("div",Z,[n(F,{lines:"two",class:"bg-blue-lighten-5"},{default:t(()=>[(i(!0),h(A,null,T(o.bill.articles,l=>(i(),_(j,{key:l.id,onClick:C=>d.goTo(l.id)},{title:t(()=>[s("strong",null,c(l.product.name),1)]),subtitle:t(()=>[s("div",$,c(l.date),1),u(" | "),s("strong",ee,c(e.formatFloatNumber(l.price))+" MAD ",1)]),prepend:t(()=>[n(y,{rounded:"0"},{default:t(()=>[n(x,{alt:"charges-timeline",class:"img_border_radius",src:"/storage/article.gif"})]),_:1})]),append:t(()=>[o.bill.user_id==d.auth.getAuth.id?(i(),_(v,{key:0,color:"red-lighten-1",icon:"mdi-trash-can",variant:"tonal",size:"x-small",onClick:C=>d.unBillArticle(l.id,o.bill.id)},null,8,["onClick"])):m("",!0)]),_:2},1032,["onClick"]))),128))]),_:1})])):m("",!0)]),_:1})]),_:1},8,["class"])])])],8,H)}const ne=E(b,[["render",te]]);export{ne as B};
