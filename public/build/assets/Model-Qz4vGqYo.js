import{u as useVuelidate,r as required,n as numeric}from"./index-B0NoHiK-.js";import{u as useArticle}from"./Article-LKTDtfjG.js";import{l as getDefaultExportFromCjs,_ as _export_sfc,k as useProduct,i as useAuth,r as resolveComponent,o as openBlock,c as createBlock,w as withCtx,a as createVNode,n as normalizeClass,p as withModifiers,b as createTextVNode,q as withKeys}from"./app-Qd38httE.js";var annyang_min={exports:{}};annyang_min.exports;(function(a){var r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};//! annyang
//! version : 2.6.1
//! author  : Tal Ater @TalAter
//! license : MIT
//! https://www.TalAter.com/annyang/
//! annyang
//! version : 2.6.1
//! author  : Tal Ater @TalAter
//! license : MIT
//! https://www.TalAter.com/annyang/
(function(t,c){r(a)==="object"&&a.exports?a.exports=c(t):t.annyang=c(t)})(typeof window<"u"?window:void 0,function(t,c){var m,d=t.SpeechRecognition||t.webkitSpeechRecognition||t.mozSpeechRecognition||t.msSpeechRecognition||t.oSpeechRecognition;if(!d)return null;var s,f,_=[],i={start:[],error:[],end:[],soundstart:[],result:[],resultMatch:[],resultNoMatch:[],errorNetwork:[],errorPermissionBlocked:[],errorPermissionDenied:[]},b=0,V=0,p=!1,w="font-weight: bold; color: #00f;",x=!1,C=!1,k=/\s*\((.*?)\)\s*/g,N=/(\(\?:[^)]+\))\?/g,R=/(\(\?)?:\w+/g,u=/\*\w+/g,T=/[\-{}\[\]+?.,\\\^$|#]/g,v=function(e){for(var o=arguments.length,n=Array(1<o?o-1:0),l=1;l<o;l++)n[l-1]=arguments[l];e.forEach(function(h){h.callback.apply(h.context,n)})},D=function(){return s!==c},y=function(e,o){e.indexOf("%c")!==-1||o?console.log(e,o||w):console.log(e)},P=function(){D()||m.init({},!1)},S=function(e,o,n){_.push({command:e,callback:o,originalPhrase:n}),p&&y("Command successfully loaded: %c"+n,w)},A=function(e){var o;v(i.result,e);for(var n=0;n<e.length;n++){o=e[n].trim(),p&&y("Speech recognized: %c"+o,w);for(var l=0,h=_.length;l<h;l++){var g=_[l],B=g.command.exec(o);if(B){var M=B.slice(1);return p&&(y("command matched: %c"+g.originalPhrase,w),M.length&&y("with parameters",M)),g.callback.apply(this,M),void v(i.resultMatch,o,g.originalPhrase,e)}}}v(i.resultNoMatch,e)};return m={init:function(e){var o=!(1<arguments.length&&arguments[1]!==c)||arguments[1];s&&s.abort&&s.abort(),(s=new d).maxAlternatives=5,s.continuous=t.location.protocol==="http:",s.lang="en-US",s.onstart=function(){C=!0,v(i.start)},s.onsoundstart=function(){v(i.soundstart)},s.onerror=function(n){switch(v(i.error,n),n.error){case"network":v(i.errorNetwork,n);break;case"not-allowed":case"service-not-allowed":f=!1,new Date().getTime()-b<200?v(i.errorPermissionBlocked,n):v(i.errorPermissionDenied,n)}},s.onend=function(){if(C=!1,v(i.end),f){var n=new Date().getTime()-b;(V+=1)%10==0&&p&&y("Speech Recognition is repeatedly stopping and starting. See http://is.gd/annyang_restarts for tips."),n<1e3?setTimeout(function(){m.start({paused:x})},1e3-n):m.start({paused:x})}},s.onresult=function(n){if(x)return p&&y("Speech heard, but annyang is paused"),!1;for(var l=n.results[n.resultIndex],h=[],g=0;g<l.length;g++)h[g]=l[g].transcript;A(h)},o&&(_=[]),e.length&&this.addCommands(e)},start:function(e){P(),x=(e=e||{}).paused!==c&&!!e.paused,f=e.autoRestart===c||!!e.autoRestart,e.continuous!==c&&(s.continuous=!!e.continuous),b=new Date().getTime();try{s.start()}catch(o){p&&y(o.message)}},abort:function(){f=!1,V=0,D()&&s.abort()},pause:function(){x=!0},resume:function(){m.start()},debug:function(){var e=!(0<arguments.length&&arguments[0]!==c)||arguments[0];p=!!e},setLanguage:function(e){P(),s.lang=e},addCommands:function(e){var o,n;for(var l in P(),e)if(e.hasOwnProperty(l))if(typeof(o=t[e[l]]||e[l])=="function")S((n=(n=l).replace(T,"\\$&").replace(k,"(?:$1)?").replace(R,function(h,g){return g?h:"([^\\s]+)"}).replace(u,"(.*?)").replace(N,"\\s*$1?\\s*"),new RegExp("^"+n+"$","i")),o,l);else{if(!((o===void 0?"undefined":r(o))==="object"&&o.regexp instanceof RegExp)){p&&y("Can not register command: %c"+l,w);continue}S(new RegExp(o.regexp.source,"i"),o.callback,l)}},removeCommands:function(e){e===c?_=[]:(e=Array.isArray(e)?e:[e],_=_.filter(function(o){for(var n=0;n<e.length;n++)if(e[n]===o.originalPhrase)return!1;return!0}))},addCallback:function(e,o,n){var l=t[o]||o;typeof l=="function"&&i[e]!==c&&i[e].push({callback:l,context:n||this})},removeCallback:function(e,o){var n=function(h){return h.callback!==o};for(var l in i)i.hasOwnProperty(l)&&(e!==c&&e!==l||(i[l]=o===c?[]:i[l].filter(n)))},isListening:function(){return C&&!x},getSpeechRecognizer:function(){return s},trigger:function(e){m.isListening()?(Array.isArray(e)||(e=[e]),A(e)):p&&y(C?"Speech heard, but annyang is paused":"Cannot trigger while annyang is aborted")}}})})(annyang_min);var annyang_minExports=annyang_min.exports;const annyang=getDefaultExportFromCjs(annyang_minExports),_sfc_main={props:{model:Object},data(){return{v$:useVuelidate(),loading_product:!1,search:"e",is_recod:!1}},computed:{maxDate:function(){return moment().format("YYYY-MM-DD")},article:function(){return useArticle()},product:function(){return useProduct()},auth:function(){return useAuth()},dateRules(){return[a=>!!a||"Date is Required"]},descriptionRules(){return[a=>(a==null?void 0:a.length)<=400||"Description Must Be less then 400 charactaers"]},productIdRules(){return[a=>!!a||"Product is Required"]},priceRules(){return[a=>(!!a||"Price is Required")&&!isNaN(a)]}},mounted:function(){annyang.setLanguage("ar-MA"),this.initAnnyang()},methods:{startRecord:function(){this.is_recod=!this.is_recod,this.is_recod?this.start():this.stopVoiceCommand()},start:function(){console.log("annyang start",annyang),annyang.start()},stopVoiceCommand:function(){console.log("annyang end"),annyang.abort(),this.is_recod=!1},initAnnyang:function(){var a={مسح:this.deleteAll,"*val":this.addNewCommand};annyang.addCommands(a),annyang.addCallback("resultNoMatch",(r,t,c)=>{this.article.overlay_text="Failed To add Description",this.article.overlay_color="red",this.article.overlay_src="/storage/microphone_mute.png",this.article.overlay_record=!0,setTimeout(()=>{this.article.overlay_record=!1},2e3),console.log("resultNoMatch"),console.log(r),console.log(t),console.log(c)}),annyang.addCallback("resultMatch",(r,t,c)=>{this.article.overlay_text="Description Added With Success",this.article.overlay_color="success",this.article.overlay_src="/storage/microphone_sound.png",this.article.overlay_record=!0,setTimeout(()=>{this.article.overlay_record=!1},2e3),console.log("resultMatch",this.article.overlay_record),console.log(r),console.log(t),console.log(c)})},addNewCommand:function(a){this.model.description+=a+`
`},deleteAll:function(a){this.model.description=""},calendarFn:function(a){return a.filter(r=>r.days.some(t=>t.text===15)).map(r=>({...r,days:r.days.map(t=>(t.classData["custom-class"]=!0,t))}))},deleteModel:function(a){this.article.deleteModel(a)},addProduct:async function(){let a=document.getElementById(this.model.id).value;if(a==""||this.product.collect.find(r=>r.name==a))return 0;this.loading_product=!0,await this.product.postProduct(a,this.model.is_private?this.auth.getAuth.id:null).then(r=>{this.loading_product=!1})}},watch:{"model.description":function(value){const regex=/\(([^)]+)\)\s*(?:dh|درهم|دراهم)|(\d+(\.\d+)?)\s*(?:dh|درهم|دراهم)/g;let sum=0,match,numbers=[];for(;(match=regex.exec(value))!==null;){let result;match[1]?(result=eval(match[1]),numbers.push(`(${match[1]})dh`)):(result=parseFloat(match[2]),numbers.push(`${result}dh`)),sum+=result}this.model.price=sum}},validations:{model:{date:{required},description:{},product_id:{required},price:{required,numeric}}}};function _sfc_render(a,r,t,c,m,d){const s=resolveComponent("v-switch"),f=resolveComponent("v-col"),_=resolveComponent("v-checkbox"),i=resolveComponent("v-btn"),b=resolveComponent("v-row"),V=resolveComponent("VueDatePicker"),p=resolveComponent("v-icon"),w=resolveComponent("v-textarea"),x=resolveComponent("v-autocomplete"),C=resolveComponent("v-text-field"),k=resolveComponent("v-card-item"),N=resolveComponent("v-card"),R=resolveComponent("v-form");return openBlock(),createBlock(R,{autocomplete:"off"},{default:withCtx(()=>[createVNode(N,{rounded:"lg",variant:"tonal",class:"my-2",color:"blue"},{default:withCtx(()=>[createVNode(k,null,{default:withCtx(()=>[createVNode(b,{"no-gutters":""},{default:withCtx(()=>[createVNode(f,{cols:"12",sm:"6"},{default:withCtx(()=>[createVNode(b,null,{default:withCtx(()=>[createVNode(f,{cols:"8"},{default:withCtx(()=>[createVNode(s,{disabled:t.model.bill_id,"hide-details":"",modelValue:t.model.is_private,"onUpdate:modelValue":r[0]||(r[0]=u=>t.model.is_private=u),inset:"",color:"blue",variant:"solo-filled","true-icon":"mdi-eye-off","false-icon":"mdi-eye",rounded:"",flat:"",label:t.model.is_private?"Private":"Public"},null,8,["disabled","modelValue","label"])]),_:1}),createVNode(f,null,{default:withCtx(()=>[createVNode(_,{"hide-details":"",modelValue:t.model.star,"onUpdate:modelValue":r[1]||(r[1]=u=>t.model.star=u),inset:"",color:"yellow",variant:"solo-filled","true-icon":"mdi-star",flat:""},null,8,["modelValue"])]),_:1}),createVNode(f,{cols:"2"},{default:withCtx(()=>[createVNode(i,{disabled:d.article.models.length<=1,class:"mt-3",size:"x-small",color:"red",variant:"tonal",icon:"mdi-close",onClick:r[2]||(r[2]=u=>d.deleteModel(t.model.id))},null,8,["disabled"])]),_:1})]),_:1})]),_:1}),createVNode(f,{cols:"12",sm:"6",class:"mb-4"},{default:withCtx(()=>[createVNode(V,{modelValue:t.model.date,"onUpdate:modelValue":r[3]||(r[3]=u=>t.model.date=u),"enable-time-picker":!1,clearable:!1,rules:d.dateRules,vertical:"","max-date":d.maxDate},null,8,["modelValue","rules","max-date"])]),_:1}),createVNode(f,{cols:"12",sm:"6"},{default:withCtx(()=>[createVNode(w,{modelValue:t.model.description,"onUpdate:modelValue":r[4]||(r[4]=u=>t.model.description=u),autocomplete:"off",variant:"solo-filled","prepend-inner-icon":"mdi-script-text",rounded:"",flat:"",label:"description",rules:d.descriptionRules,counter:""},{"append-inner":withCtx(()=>[createVNode(i,{class:normalizeClass(m.is_recod?"circle-ripple-record":""),disbaled:d.auth.user.activate,color:m.is_recod?"amber":"red",loading:m.loading_product,onClick:withModifiers(d.startRecord,["prevent"]),size:"x-small",icon:"",variant:m.is_recod?"flat":"elevated"},{default:withCtx(()=>[m.is_recod?(openBlock(),createBlock(p,{key:0,color:"white"},{default:withCtx(()=>[createTextVNode("mdi-microphone-plus")]),_:1})):(openBlock(),createBlock(p,{key:1,color:"white"},{default:withCtx(()=>[createTextVNode("mdi-microphone-off")]),_:1}))]),_:1},8,["class","disbaled","color","loading","onClick","variant"])]),_:1},8,["modelValue","rules"])]),_:1}),createVNode(f,{cols:"12",sm:"6"},{default:withCtx(()=>[createVNode(x,{modelValue:t.model.product_id,"onUpdate:modelValue":r[5]||(r[5]=u=>t.model.product_id=u),id:t.model.id+"",items:d.product.collect.filter(u=>t.model.is_private?u.user_id==d.auth.getAuth.id:u.user_id==null),"auto-select-first":"",disbaled:!d.auth.user.activate,chips:"",onKeydown:withKeys(withModifiers(d.addProduct,["prevent"]),["enter"]),autocomplete:"off","item-title":"name","item-value":"id","open-text":m.search,variant:"solo-filled",rounded:"",flat:"",label:"Products List",rules:d.productIdRules},{"prepend-inner":withCtx(()=>[createVNode(i,{disbaled:d.auth.user.activate,color:"green",loading:m.loading_product,onClick:withModifiers(d.addProduct,["prevent"]),size:"x-small",icon:"",variant:"tonal"},{default:withCtx(()=>[createVNode(p,null,{default:withCtx(()=>[createTextVNode("mdi-cart-arrow-down")]),_:1})]),_:1},8,["disbaled","loading","onClick"])]),_:1},8,["modelValue","id","items","disbaled","onKeydown","open-text","rules"])]),_:1}),createVNode(f,{cols:"12",sm:"6"},{default:withCtx(()=>[createVNode(C,{modelValue:t.model.price,"onUpdate:modelValue":r[6]||(r[6]=u=>t.model.price=u),suffix:"DH",autocomplete:"off",variant:"solo-filled","prepend-inner-icon":"mdi-cash",rounded:"",flat:"",label:"Price",rules:d.priceRules,type:"number"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const Model=_export_sfc(_sfc_main,[["render",_sfc_render]]);export{Model as M};
