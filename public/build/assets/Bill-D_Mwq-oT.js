import{_ as L,v as O,g as R,r as a,o as i,e as h,h as n,a as s,w as t,b as u,t as c,c as _,j as m,F as A,f as N,n as q,p as G,l as H}from"./app-C9xsYPRO.js";const v={props:{bill:Object},data:function(){return{expand_articles:!1,expand_invoices:!1,loading:!1,loading_bill:!1,on_delete:!1,pause:!1,setTimeout:null,setInterval:null,counter:1,color:"white"}},mounted:function(){this.bill.user_id==this.auth.getAuth.id&&this.$nextTick(()=>{const e="#"+this.bill.id,r=new Swiper(e,{resistanceRatio:.85,initialSlide:0,resistance:!0,allowSlideNext:!1,momentumBounce:!0,speed:150});r.on("transitionStart",()=>{this.on_delete=!0,this.loading=!0,this.setTimeout=setTimeout(()=>{this.deleteBill().then(o=>{r.destroy()})},3e3),this.setInterval=setInterval(()=>{++this.counter},1e3)})})},computed:{_bill:function(){return O()},dashboard:function(){return useDashboard()},auth:function(){return R()}},methods:{deleteBill:async function(){return await this._bill.deleteBill(this.bill.id).then(e=>{this.$route.params.id&&this.$router.push({name:"bills.list"})})},aditBill:function(){this.$router.push({name:"bills.update",params:{id:this.bill.id}})},viewBill:function(){this.$router.push({name:"bills.view",params:{id:this.bill.id}})},cancelBill:async function(){return this.loading_bill=!0,await this._bill.cancelBill(this.bill).then(e=>(this.loading_bill=!1,e))},toggleBill:function(){this._bill.toggleBill(this.bill.id)},unBillArticle:async function(e,r){this.loading_bill=!0,await this._bill.unBillArticle(e,r).then(o=>{this.loading_bill=!1,o&&(this.bill.articles=this.bill.articles.filter(f=>f.id!=e))})},rollback:function(){this.pause=!0,clearTimeout(this.setTimeout),clearInterval(this.setInterval),this.on_delete=!1,this.counter=1,setTimeout(()=>{this.loading=!1,this.pause=!1},1e3)},toggleInvoice:function(e){this._bill.toggleInvoice(e.id,!e.checked),e.checked=!e.checked},goTo:function(e){this.$router.push(`/articles/view/${e}`)}}},T=()=>{G(e=>({"27cddec4":e.color}))},z=v.setup;v.setup=z?(e,r)=>(T(),z(e,r)):T;const J=["id"],K={class:"swiper-wrapper"},P={class:"swiper-slide"},Q={key:1},U=n("thead",null,[n("tr",null,[n("th",{class:"text-left pr-0"}," Name "),n("th",{class:"text-left px-0"}," Spent "),n("th",{class:"text-left px-0"}," Amount "),n("th",{class:"text-left"})])],-1),W={class:"text-left pr-0"},X={class:"text-left px-0 text-red"},Y={class:"text-left px-0"},Z={class:"text-left px-0"},$={key:0,class:"bg-blue-lighten-5"},ee={class:"d-inline"},te={class:"d-inline text-green"};function le(e,r,o,f,ie,d){const D=a("v-progress-linear"),p=a("v-chip"),g=a("v-icon"),I=a("v-card-text"),M=a("v-progress-circular"),k=a("v-checkbox"),x=a("v-img"),y=a("v-avatar"),w=a("v-spacer"),b=a("v-btn"),S=a("v-card-actions"),F=a("v-table"),B=a("v-expand-transition"),V=a("v-list-item"),j=a("v-list"),E=a("v-card");return i(),h("div",{id:o.bill.id,class:"swiper-container"},[n("div",K,[n("div",P,[s(E,{hover:"",class:q(["mx-auto",{on_delete:e.on_delete}])},{loader:t(()=>[s(D,{active:e.loading_bill,indeterminate:"",height:"3",color:"blue"},null,8,["active"])]),subtitle:t(()=>[u(c(o.bill.date)+" | Created : ",1),d.auth.getAuth.id==o.bill.user_id?(i(),_(p,{key:0,size:"x-small",color:"green"},{default:t(()=>[u("Me")]),_:1})):(i(),_(p,{key:1,size:"x-small",color:"blue"},{default:t(()=>[u(c(o.bill.user.name),1)]),_:1}))]),title:t(()=>[u(" Bill NÂ° : "+c(o.bill.id),1)]),append:t(()=>[e.loading?(i(),h("div",{key:0,class:"cursor-pointer",onClick:r[0]||(r[0]=(...l)=>d.rollback&&d.rollback(...l))},[s(M,{size:30,width:1,color:"primary",indeterminate:""},{default:t(()=>[e.pause?(i(),_(g,{key:0},{default:t(()=>[u(" mdi-pause ")]),_:1})):(i(),h("span",Q,c(e.counter),1))]),_:1})])):m("",!0),n("div",null,[!e.$route.params.id&&d.auth.getAuth.id==o.bill.user_id?(i(),_(k,{key:0,"model-value":!!o.bill.selected,"hide-details":"",onClick:d.toggleBill,color:"primary"},null,8,["model-value","onClick"])):m("",!0)])]),prepend:t(()=>[s(y,{rounded:"0"},{default:t(()=>[s(x,{alt:"receipt",class:"img_border_radius",src:"/storage/receipt.gif"})]),_:1})]),default:t(()=>[s(I,null,{default:t(()=>[s(g,{color:"green",class:"mx-3 pb-2"},{default:t(()=>[u("mdi-cash-multiple")]),_:1}),n("strong",null,c(o.bill.amount),1),u(" MAD ")]),_:1}),s(w),s(S,{class:"bg-blue-lighten-5"},{default:t(()=>[s(w),s(b,{class:"mr-2",color:"deep-purple-darken-1",size:"x-small",variant:"tonal",icon:e.expand_invoices?"mdi-chevron-up":"mdi-chevron-down",onClick:r[1]||(r[1]=l=>e.expand_invoices=!e.expand_invoices)},null,8,["icon"]),s(b,{class:"mr-2",color:"blue-darken-1",size:"x-small",variant:"tonal",icon:e.expand_articles?"mdi-chevron-up":"mdi-chevron-down",onClick:r[2]||(r[2]=l=>e.expand_articles=!e.expand_articles)},null,8,["icon"]),e.$route.params.id?m("",!0):(i(),_(b,{key:0,class:"mr-2",color:"green-darken-1",size:"x-small",variant:"tonal",icon:"mdi-text-box",onClick:d.viewBill},null,8,["onClick"]))]),_:1}),s(B,null,{default:t(()=>[e.expand_invoices?(i(),_(F,{key:0},{default:t(()=>[U,n("tbody",null,[(i(!0),h(A,null,N(o.bill.invoices,l=>(i(),h("tr",{key:l.id},[n("td",W,c(l.user.name),1),n("td",X," -"+c(e.formatFloatNumber(l.spent))+" MAD ",1),n("td",Y,[l.price>0?(i(),_(p,{key:0,variant:"tonal",color:"green"},{default:t(()=>[u(c(e.formatFloatNumber(l.price))+" MAD",1)]),_:2},1024)):l.price==0?(i(),_(p,{key:1,variant:"tonal",color:"gray"},{default:t(()=>[u(c(e.formatFloatNumber(l.price))+" MAD",1)]),_:2},1024)):(i(),_(p,{key:2,variant:"tonal",color:"red"},{default:t(()=>[u(c(e.formatFloatNumber(l.price))+" MAD",1)]),_:2},1024))]),n("td",Z,[s(k,{"model-value":!!l.checked,"hide-details":"",onClick:C=>d.toggleInvoice(l),color:"primary",disabled:d.auth.getAuth.id!=l.user_id},null,8,["model-value","onClick","disabled"])])]))),128))])]),_:1})):m("",!0)]),_:1}),s(B,null,{default:t(()=>[e.expand_articles?(i(),h("div",$,[s(j,{lines:"two",class:"bg-blue-lighten-5"},{default:t(()=>[(i(!0),h(A,null,N(o.bill.articles,l=>(i(),_(V,{key:l.id,onClick:C=>d.goTo(l.id)},{title:t(()=>[n("strong",null,c(l.product.name),1)]),subtitle:t(()=>[n("div",ee,c(l.date),1),u(" | "),n("strong",te,c(e.formatFloatNumber(l.price))+" MAD ",1)]),prepend:t(()=>[s(y,{rounded:"0"},{default:t(()=>[s(x,{alt:"charges-timeline",class:"img_border_radius",src:"/storage/article.gif"})]),_:1})]),append:t(()=>[o.bill.user_id==d.auth.getAuth.id?(i(),_(b,{key:0,color:"red-lighten-1",icon:"mdi-trash-can",variant:"tonal",size:"x-small",onClick:H(C=>d.unBillArticle(l.id,o.bill.id),["stop"])},null,8,["onClick"])):m("",!0)]),_:2},1032,["onClick"]))),128))]),_:1})])):m("",!0)]),_:1})]),_:1},8,["class"])])])],8,J)}const ne=L(v,[["render",le]]);export{ne as B};
