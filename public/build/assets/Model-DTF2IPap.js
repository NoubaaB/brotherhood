import{u as useVuelidate,r as required,n as numeric}from"./index-Cpn2i1Vl.js";import{u as useArticle}from"./Article-BI4Pza_X.js";import{_ as _export_sfc,k as useProduct,i as useAuth,r as resolveComponent,o as openBlock,c as createBlock,w as withCtx,a as createVNode,l as withKeys,n as withModifiers,b as createTextVNode}from"./app-CP-hQ5E3.js";const _sfc_main={props:{model:Object},data(){return{v$:useVuelidate(),loading_product:!1,search:"e"}},computed:{maxDate:function(){return moment().format("YYYY-MM-DD")},article:function(){return useArticle()},product:function(){return useProduct()},auth:function(){return useAuth()},dateRules(){return[l=>!!l||"Date is Required"]},descriptionRules(){return[l=>(l==null?void 0:l.length)<=400||"Description Must Be less then 400 charactaers"]},productIdRules(){return[l=>!!l||"Product is Required"]},priceRules(){return[l=>(!!l||"Price is Required")&&!isNaN(l)]}},methods:{calendarFn:function(l){return l.filter(e=>e.days.some(t=>t.text===15)).map(e=>({...e,days:e.days.map(t=>(t.classData["custom-class"]=!0,t))}))},deleteModel:function(l){this.article.deleteModel(l)},addProduct:async function(){let l=document.getElementById(this.model.id).value;if(l==""||this.product.collect.find(e=>e.name==l))return 0;this.loading_product=!0,await this.product.postProduct(l,this.model.is_private?this.auth.getAuth.id:null).then(e=>{this.loading_product=!1})}},watch:{"model.description":function(value){const regex=/\(([^)]+)\)\s*dh|(\d+(\.\d+)?)\s*dh/g;let sum=0,match,numbers=[];for(;(match=regex.exec(value))!==null;){let result;match[1]?(result=eval(match[1]),numbers.push(`(${match[1]})dh`)):(result=parseFloat(match[2]),numbers.push(`${result}dh`)),sum+=result}this.model.price=sum}},validations:{model:{date:{required},description:{},product_id:{required},price:{required,numeric}}}};function _sfc_render(l,e,t,x,r,d){const u=resolveComponent("v-switch"),a=resolveComponent("v-col"),s=resolveComponent("v-checkbox"),n=resolveComponent("v-btn"),i=resolveComponent("v-row"),c=resolveComponent("VueDatePicker"),m=resolveComponent("v-textarea"),f=resolveComponent("v-icon"),_=resolveComponent("v-autocomplete"),v=resolveComponent("v-text-field"),p=resolveComponent("v-card-item"),h=resolveComponent("v-card"),V=resolveComponent("v-form");return openBlock(),createBlock(V,{autocomplete:"off"},{default:withCtx(()=>[createVNode(h,{rounded:"lg",variant:"tonal",class:"my-2",color:"blue"},{default:withCtx(()=>[createVNode(p,null,{default:withCtx(()=>[createVNode(i,{"no-gutters":""},{default:withCtx(()=>[createVNode(a,{cols:"12",sm:"6"},{default:withCtx(()=>[createVNode(i,null,{default:withCtx(()=>[createVNode(a,{cols:"8"},{default:withCtx(()=>[createVNode(u,{disabled:t.model.bill_id,"hide-details":"",modelValue:t.model.is_private,"onUpdate:modelValue":e[0]||(e[0]=o=>t.model.is_private=o),inset:"",color:"blue",variant:"solo-filled","true-icon":"mdi-eye-off","false-icon":"mdi-eye",rounded:"",flat:"",label:t.model.is_private?"Private":"Public"},null,8,["disabled","modelValue","label"])]),_:1}),createVNode(a,null,{default:withCtx(()=>[createVNode(s,{"hide-details":"",modelValue:t.model.star,"onUpdate:modelValue":e[1]||(e[1]=o=>t.model.star=o),inset:"",color:"yellow",variant:"solo-filled","true-icon":"mdi-star",flat:""},null,8,["modelValue"])]),_:1}),createVNode(a,{cols:"2"},{default:withCtx(()=>[createVNode(n,{disabled:d.article.models.length<=1,class:"mt-3",size:"x-small",color:"red",variant:"tonal",icon:"mdi-close",onClick:e[2]||(e[2]=o=>d.deleteModel(t.model.id))},null,8,["disabled"])]),_:1})]),_:1})]),_:1}),createVNode(a,{cols:"12",sm:"6",class:"mb-4"},{default:withCtx(()=>[createVNode(c,{modelValue:t.model.date,"onUpdate:modelValue":e[3]||(e[3]=o=>t.model.date=o),"enable-time-picker":!1,clearable:!1,rules:d.dateRules,vertical:"","max-date":d.maxDate},null,8,["modelValue","rules","max-date"])]),_:1}),createVNode(a,{cols:"12",sm:"6"},{default:withCtx(()=>[createVNode(m,{modelValue:t.model.description,"onUpdate:modelValue":e[4]||(e[4]=o=>t.model.description=o),autocomplete:"off",variant:"solo-filled","prepend-inner-icon":"mdi-script-text",rounded:"",flat:"",label:"description",rules:d.descriptionRules,counter:""},null,8,["modelValue","rules"])]),_:1}),createVNode(a,{cols:"12",sm:"6"},{default:withCtx(()=>[createVNode(_,{modelValue:t.model.product_id,"onUpdate:modelValue":e[5]||(e[5]=o=>t.model.product_id=o),id:t.model.id+"",items:d.product.collect.filter(o=>t.model.is_private?o.user_id==d.auth.getAuth.id:o.user_id==null),"auto-select-first":"",disbaled:!d.auth.user.activate,chips:"",onKeydown:withKeys(withModifiers(d.addProduct,["prevent"]),["enter"]),autocomplete:"off","item-title":"name","item-value":"id","open-text":r.search,variant:"solo-filled",rounded:"",flat:"",label:"Products List",rules:d.productIdRules},{"prepend-inner":withCtx(()=>[createVNode(n,{disbaled:d.auth.user.activate,color:"green",loading:r.loading_product,onClick:withModifiers(d.addProduct,["prevent"]),size:"x-small",icon:"",variant:"tonal"},{default:withCtx(()=>[createVNode(f,null,{default:withCtx(()=>[createTextVNode("mdi-cart-arrow-down")]),_:1})]),_:1},8,["disbaled","loading","onClick"])]),_:1},8,["modelValue","id","items","disbaled","onKeydown","open-text","rules"])]),_:1}),createVNode(a,{cols:"12",sm:"6"},{default:withCtx(()=>[createVNode(v,{modelValue:t.model.price,"onUpdate:modelValue":e[6]||(e[6]=o=>t.model.price=o),suffix:"DH",autocomplete:"off",variant:"solo-filled","prepend-inner-icon":"mdi-cash",rounded:"",flat:"",label:"Price",rules:d.priceRules,type:"number"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const Model=_export_sfc(_sfc_main,[["render",_sfc_render]]);export{Model as M};
