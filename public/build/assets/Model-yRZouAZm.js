import{u as useVuelidate,r as required,n as numeric}from"./index-Ce0plcII.js";import{u as useArticle}from"./Article-UMDzGyj5.js";import{_ as _export_sfc,k as useProduct,i as useAuth,r as resolveComponent,o as openBlock,c as createBlock,w as withCtx,a as createVNode,l as withKeys,n as withModifiers,b as createTextVNode}from"./app-CgKV6O7-.js";const _sfc_main={props:{model:Object},data(){return{v$:useVuelidate(),loading_product:!1,search:"e"}},computed:{maxDate:function(){return moment().format("YYYY-MM-DD")},article:function(){return useArticle()},product:function(){return useProduct()},auth:function(){return useAuth()},dateRules(){return[o=>!!o||"Date is Required"]},descriptionRules(){return[o=>(o==null?void 0:o.length)<=400||"Description Must Be less then 400 charactaers"]},productIdRules(){return[o=>!!o||"Product is Required"]},priceRules(){return[o=>(!!o||"Price is Required")&&!isNaN(o)]}},methods:{calendarFn:function(o){return o.filter(e=>e.days.some(t=>t.text===15)).map(e=>({...e,days:e.days.map(t=>(t.classData["custom-class"]=!0,t))}))},deleteModel:function(o){this.article.deleteModel(o)},addProduct:async function(){let o=document.getElementById(this.model.id).value;if(o==""||this.product.collect.find(e=>e.name==o))return 0;this.loading_product=!0,await this.product.postProduct(o,this.model.is_private?this.auth.getAuth.id:null).then(e=>{this.loading_product=!1})}},watch:{"model.description":function(value){const regex=/\(([^)]+)\)\s*dh|(\d+(\.\d+)?)\s*dh/g;let sum=0,match,numbers=[];for(;(match=regex.exec(value))!==null;){let result;match[1]?(result=eval(match[1]),numbers.push(`(${match[1]})dh`)):(result=parseFloat(match[2]),numbers.push(`${result}dh`)),sum+=result}this.model.price=sum}},validations:{model:{date:{required},description:{},product_id:{required},price:{required,numeric}}}};function _sfc_render(o,e,t,x,a,d){const u=resolveComponent("v-switch"),r=resolveComponent("v-col"),s=resolveComponent("v-checkbox"),n=resolveComponent("v-btn"),i=resolveComponent("v-row"),c=resolveComponent("VueDatePicker"),m=resolveComponent("v-textarea"),f=resolveComponent("v-icon"),_=resolveComponent("v-autocomplete"),p=resolveComponent("v-text-field"),v=resolveComponent("v-card-item"),h=resolveComponent("v-card"),V=resolveComponent("v-form");return openBlock(),createBlock(V,{autocomplete:"off"},{default:withCtx(()=>[createVNode(h,{rounded:"lg",variant:"tonal",class:"my-2",color:"blue"},{default:withCtx(()=>[createVNode(v,null,{default:withCtx(()=>[createVNode(i,{"no-gutters":""},{default:withCtx(()=>[createVNode(r,{cols:"12",sm:"6"},{default:withCtx(()=>[createVNode(i,null,{default:withCtx(()=>[createVNode(r,{cols:"8"},{default:withCtx(()=>[createVNode(u,{disabled:t.model.bill_id,"hide-details":"",modelValue:t.model.is_private,"onUpdate:modelValue":e[0]||(e[0]=l=>t.model.is_private=l),inset:"",color:"blue",variant:"solo-filled","true-icon":"mdi-eye-off","false-icon":"mdi-eye",rounded:"",flat:"",label:t.model.is_private?"Private":"Public"},null,8,["disabled","modelValue","label"])]),_:1}),createVNode(r,null,{default:withCtx(()=>[createVNode(s,{"hide-details":"",modelValue:t.model.star,"onUpdate:modelValue":e[1]||(e[1]=l=>t.model.star=l),inset:"",color:"yellow",variant:"solo-filled","true-icon":"mdi-star",flat:""},null,8,["modelValue"])]),_:1}),createVNode(r,{cols:"2"},{default:withCtx(()=>[createVNode(n,{disabled:d.article.models.length<=1,class:"mt-3",size:"x-small",color:"red",variant:"tonal",icon:"mdi-close",onClick:e[2]||(e[2]=l=>d.deleteModel(t.model.id))},null,8,["disabled"])]),_:1})]),_:1})]),_:1}),createVNode(r,{cols:"12",sm:"6",class:"mb-4"},{default:withCtx(()=>[createVNode(c,{modelValue:t.model.date,"onUpdate:modelValue":e[3]||(e[3]=l=>t.model.date=l),"enable-time-picker":!1,clearable:!1,rules:d.dateRules,vertical:"","max-date":d.maxDate},null,8,["modelValue","rules","max-date"])]),_:1}),createVNode(r,{cols:"12",sm:"6"},{default:withCtx(()=>[createVNode(m,{modelValue:t.model.description,"onUpdate:modelValue":e[4]||(e[4]=l=>t.model.description=l),autocomplete:"off",variant:"solo-filled","prepend-inner-icon":"mdi-script-text",rounded:"",flat:"",label:"description",rules:d.descriptionRules,counter:""},null,8,["modelValue","rules"])]),_:1}),createVNode(r,{cols:"12",sm:"6"},{default:withCtx(()=>[createVNode(_,{modelValue:t.model.product_id,"onUpdate:modelValue":e[5]||(e[5]=l=>t.model.product_id=l),id:t.model.id+"",items:d.product.collect.filter(l=>t.model.is_private?l.user_id==d.auth.getAuth.id:l.user_id==null),"auto-select-first":"",chips:"",onKeydown:withKeys(withModifiers(d.addProduct,["prevent"]),["enter"]),autocomplete:"off","item-title":"name","item-value":"id","open-text":a.search,variant:"solo-filled",rounded:"",flat:"",label:"Products List",rules:d.productIdRules},{"prepend-inner":withCtx(()=>[createVNode(n,{color:"green",loading:a.loading_product,onClick:withModifiers(d.addProduct,["prevent"]),size:"x-small",icon:"",variant:"tonal"},{default:withCtx(()=>[createVNode(f,null,{default:withCtx(()=>[createTextVNode("mdi-cart-arrow-down")]),_:1})]),_:1},8,["loading","onClick"])]),_:1},8,["modelValue","id","items","onKeydown","open-text","rules"])]),_:1}),createVNode(r,{cols:"12",sm:"6"},{default:withCtx(()=>[createVNode(p,{modelValue:t.model.price,"onUpdate:modelValue":e[6]||(e[6]=l=>t.model.price=l),suffix:"DH",autocomplete:"off",variant:"solo-filled","prepend-inner-icon":"mdi-cash",rounded:"",flat:"",label:"Price",rules:d.priceRules,type:"number"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const Model=_export_sfc(_sfc_main,[["render",_sfc_render]]);export{Model as M};
